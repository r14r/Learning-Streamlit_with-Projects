{{ define "main" }}
<div class="layout">
  <aside class="sidebar">
    <h1>{{ .Site.Title }}</h1>
    <nav>
      {{ range $level := .Site.Data.content.levels }}
        <div class="nav-section">
          <a class="nav-level" href="#{{ $level.id | urlize }}">{{ $level.title }}</a>
          <ul>
            {{ range $project := $level.projects }}
              <li>
                <a href="#{{ printf "%s-%s" $level.id $project.id | urlize }}">{{ $project.title }}</a>
                <ul>
                  {{ range $step := $project.steps }}
                    <li>
                      <a href="#{{ printf "%s-%s-%s" $level.id $project.id $step.id | urlize }}">{{ $step.filename }}</a>
                    </li>
                  {{ end }}
                </ul>
              </li>
            {{ end }}
          </ul>
        </div>
      {{ end }}
    </nav>
  </aside>
  <main class="content">
    {{ range $level := .Site.Data.content.levels }}
      <section id="{{ $level.id | urlize }}" class="level">
        <h2>{{ $level.title }}</h2>
        {{ range $project := $level.projects }}
          <section id="{{ printf "%s-%s" $level.id $project.id | urlize }}" class="project">
            <h3>{{ $project.title }}</h3>
            <div class="project-meta">
              <div>
                <h4>TODO</h4>
                {{ if $project.todo_path }}
                  <div class="markdown">{{ readFile $project.todo_path | markdownify }}</div>
                {{ else }}
                  <pre>No TODO.md provided.</pre>
                {{ end }}
              </div>
              <div>
                <h4>TIPPS</h4>
                {{ if $project.tipps_path }}
                  <div class="markdown">{{ readFile $project.tipps_path | markdownify }}</div>
                {{ else }}
                  <pre>No TIPPS.md provided.</pre>
                {{ end }}
              </div>
            </div>
            <div class="steps">
              {{ range $step := $project.steps }}
                <article id="{{ printf "%s-%s-%s" $level.id $project.id $step.id | urlize }}" class="step">
                  <h4>{{ $step.filename }}</h4>
                  {{ if $step.path }}
                    <div class="code-block">{{ readFile $step.path | markdownify }}</div>
                  {{ else }}
                    <pre>No step content available.</pre>
                  {{ end }}
                </article>
              {{ end }}
            </div>
          </section>
        {{ end }}
      </section>
    {{ end }}
  </main>
</div>
{{ end }}
