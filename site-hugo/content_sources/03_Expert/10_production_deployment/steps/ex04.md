```py
"""
Step 4: Best Practices and Complete Guide
- Comprehensive best practices
- Security guidelines
- Performance tips
- Monitoring strategies
"""

import streamlit as st

st.set_page_config(page_title="Production Deployment", page_icon="üöÄ", layout="wide")

st.title("üöÄ Production Deployment Guide")

# Create comprehensive tabs
tab1, tab2, tab3, tab4 = st.tabs([
    "Overview",
    "Checklist",
    "Platforms",
    "Best Practices"
])

# Tab 1: Overview
with tab1:
    st.header("Deployment Overview")
    st.markdown("""
    ### Deployment Options:

    1. **Streamlit Community Cloud** (Free)
       - Direct GitHub integration
       - Free for public repos
       - Automatic deployments

    2. **Heroku**
       - Full control
       - Custom domains
       - Add-ons available

    3. **AWS/Azure/GCP**
       - Enterprise-grade
       - Scalable
       - Advanced features

    4. **Docker**
       - Containerized
       - Portable
       - Consistent environments
    """)

# Tab 2: Checklist
with tab2:
    st.header("‚úÖ Deployment Checklist")

    checklist = [
        "Add requirements.txt with all dependencies",
        "Create .streamlit/config.toml for settings",
        "Add .gitignore for sensitive files",
        "Test with production-like data",
        "Optimize caching strategy",
        "Add error handling",
        "Set up logging",
        "Configure secrets management",
        "Test responsiveness",
        "Add analytics/monitoring"
    ]

    for item in checklist:
        st.checkbox(item, key=item)

# Tab 3: Platforms
with tab3:
    st.header("üåê Deployment Platforms")

    col1, col2 = st.columns(2)

    with col1:
        st.subheader("Streamlit Cloud")
        st.code("""
# 1. Push to GitHub
git push origin main

# 2. Visit share.streamlit.io
# 3. Connect your GitHub repo
# 4. Deploy!
        """)

    with col2:
        st.subheader("Docker")
        st.code("""
FROM python:3.9-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .

EXPOSE 8501

CMD ["streamlit", "run", "app.py"]
        """)

# Tab 4: Best Practices (THE COMPLETE SECTION)
with tab4:
    st.header("üéØ Best Practices")

    # Performance section
    st.subheader("‚ö° Performance")
    st.markdown("""
    ### Optimization Strategies

    **Caching:**
    ```python
    # Use @st.cache_data for expensive computations
    @st.cache_data
    def load_data():
        return pd.read_csv('large_file.csv')

    # Use @st.cache_resource for ML models/connections
    @st.cache_resource
    def load_model():
        return load_ml_model()
    ```

    **Pagination:**
    ```python
    # Display data in chunks
    page_size = 50
    page = st.number_input("Page", 1, total_pages)
    start = (page - 1) * page_size
    st.dataframe(df[start:start + page_size])
    ```

    **Optimize Images:**
    - Compress images before upload
    - Use appropriate formats (WebP, optimized JPEG)
    - Lazy load images when possible
    """)

    st.divider()

    # Security section
    st.subheader("üîí Security")
    st.markdown("""
    ### Security Best Practices

    **Never Commit Secrets:**
    ```python
    # ‚ùå BAD - Never do this
    API_KEY = "sk-123456789"

    # ‚úÖ GOOD - Use st.secrets
    API_KEY = st.secrets["API_KEY"]
    ```

    **Validate User Inputs:**
    ```python
    user_input = st.text_input("Enter email")

    # Validate before using
    if user_input and "@" in user_input:
        process_email(user_input)
    else:
        st.error("Invalid email")
    ```

    **Sanitize Data:**
    ```python
    # Prevent SQL injection
    cursor.execute(
        "SELECT * FROM users WHERE id = ?",
        (user_id,)  # Parameterized query
    )
    ```

    **Use HTTPS:**
    - Always deploy with SSL/TLS
    - Most platforms provide this automatically
    - Never transmit sensitive data over HTTP

    **.gitignore Configuration:**
    ```gitignore
    .env
    secrets.toml
    *.key
    *.pem
    __pycache__/
    *.db
    ```
    """)

    st.divider()

    # Monitoring section
    st.subheader("üìä Monitoring")
    st.markdown("""
    ### Monitoring & Logging

    **Error Logging:**
    ```python
    import logging

    logging.basicConfig(level=logging.INFO)
    logger = logging.getLogger(__name__)

    try:
        result = expensive_operation()
    except Exception as e:
        logger.error(f"Operation failed: {e}")
        st.error("Something went wrong")
    ```

    **Track Errors:**
    ```python
    # Use try-except blocks
    try:
        data = load_data()
    except FileNotFoundError:
        st.error("Data file not found")
    except pd.errors.EmptyDataError:
        st.warning("Data file is empty")
    except Exception as e:
        st.error(f"Unexpected error: {e}")
    ```

    **Performance Monitoring:**
    ```python
    import time

    start = time.time()
    result = expensive_function()
    elapsed = time.time() - start

    if elapsed > 5.0:
        logger.warning(f"Slow operation: {elapsed:.2f}s")
    ```

    **Health Checks:**
    ```python
    # Add a health check endpoint
    # Most platforms support this
    if st.sidebar.button("Health Check"):
        st.success("‚úÖ App is healthy")
    ```
    """)

    st.divider()

    # User Experience section
    st.subheader("üé® User Experience")
    st.markdown("""
    ### UX Best Practices

    **Loading Indicators:**
    ```python
    with st.spinner("Loading data..."):
        data = load_large_dataset()
    ```

    **Error Messages:**
    ```python
    # ‚ùå BAD
    st.error("Error")

    # ‚úÖ GOOD
    st.error("Failed to load data. Please check your connection and try again.")
    ```

    **Mobile Responsiveness:**
    - Use `use_container_width=True` for charts
    - Test on different screen sizes
    - Avoid horizontal scrolling
    - Use appropriate column layouts

    **Progress Feedback:**
    ```python
    progress = st.progress(0)
    for i in range(100):
        # Process item
        progress.progress(i + 1)
    ```

    **Help Text:**
    ```python
    st.text_input(
        "API Key",
        help="Enter your API key from the dashboard"
    )
    ```
    """)

    st.divider()

    # Deployment workflow section
    st.subheader("üîÑ Deployment Workflow")
    st.markdown("""
    ### Recommended Workflow

    **1. Development:**
    ```bash
    # Local development
    streamlit run app.py

    # Test changes
    # Add features
    # Fix bugs
    ```

    **2. Testing:**
    ```bash
    # Test with production-like data
    # Verify all features
    # Check performance
    # Test error cases
    ```

    **3. Staging:**
    ```bash
    # Deploy to staging environment
    # Final testing
    # User acceptance testing
    ```

    **4. Production:**
    ```bash
    # Deploy to production
    git add .
    git commit -m "Release v1.0"
    git push origin main

    # Monitor deployment
    # Check logs
    # Verify functionality
    ```

    **5. Monitoring:**
    ```bash
    # Monitor performance
    # Track errors
    # Gather user feedback
    # Plan improvements
    ```
    """)

    st.divider()

    # Common issues section
    st.subheader("‚ö†Ô∏è Common Issues & Solutions")
    st.markdown("""
    ### Troubleshooting

    | Issue | Solution |
    |-------|----------|
    | **App won't start** | Check requirements.txt, verify all dependencies install |
    | **Slow performance** | Implement caching, pagination, optimize queries |
    | **Memory errors** | Reduce data size, use pagination, optimize memory usage |
    | **Module not found** | Add missing package to requirements.txt |
    | **Secrets not working** | Verify secrets.toml format, check platform docs |
    | **Port already in use** | Change port in config or kill existing process |

    ### Debug Tips

    1. **Check logs first** - Most errors are in the logs
    2. **Test locally** - Reproduce issues in development
    3. **Verify requirements** - Ensure all packages are listed
    4. **Check platform limits** - Memory, CPU, storage
    5. **Monitor resources** - Track usage patterns
    6. **Test incrementally** - Deploy small changes
    """)

st.divider()
st.caption("Built with Streamlit üéà")

```